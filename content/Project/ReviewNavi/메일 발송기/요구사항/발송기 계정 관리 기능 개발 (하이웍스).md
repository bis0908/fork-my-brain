---
Create at: 2024-01-22
tags:
  - specification
---
---

#### 목적
1. 스팸 등록 회피를 위해 도메인에서 생성된 다수의 메일 계정으로 광고 메일을 보내는 시스템 내부에서 발송기 id로 할당된 메일 발송용 계정을 변경하는 로직을 개발.

#### 분석
1. 현재 도메인은 2개 사용중.
	1. 도메인별로 메일 계정이 있음.

#### 시나리오
1. 발송기 UI에서 발송용 계정 수정 버튼을 클릭
2. 새로운 계정명 지정 후 엔터 or 버튼 클릭
3. 현재 계정으로 발송기가 실행중인지 확인
	1. 발송중인지 or 발송 예약이 걸려있는지 or 즉시 발송 실행중인지 확인
	2. 조건이 True
		1. 처리방법 고민해보기
		2. 작업 대기를 한 다음 종료되면 진행하는게 가능할까?
	3. False
		1. 해당 도메인에 맞는 토큰으로 새로운 이름이 등록되어 있는지 확인
		2. 조건문 분기
			1. 이미 존재하면 경고 및 종료
			2. 존재하지 않으면
				1. 브라우저 제어(Puppeteer)로 이름 변경 프로세스 수행 (try/catch)
				2. 프로세스 성공시 db에서 수정 전 계정명을 수정된 계정명으로 모두 바꾸기 시도 (try/catch)
				3. try/catch가 중첩되지 않고 깔끔하게 수행되려면?

#### 관련 정보
- API-token(조직 조회)
	- ~.co.kr
		- 리뷰나비: c7b74126a4a9c60a8001211d0502d96d
	- ~.kr
		- rena_kr_tkn: 03f6c40b77bb2d480af09d0a1e78932b
- **ID 변경시 유의사항**
	- ID를 변경하시면, 이전 메일주소로는 더 이상 수신할 수 없습니다.  (이미 수취한 메일은 확인 가능)
	- 사용자 환경의 ‘회신메일주소’는 새로운 메일주소로 자동 변경됩니다.
	- ID는 특수문자로 시작할 수 없으며, 2~20자리의 영문 소문자, 숫자,  '-', '_', '.'만 가능합니다.
	- **ID 변경시, 이 계정에서 사용 중이던 브라우저 및 모든 기기에서 로그아웃됩니다.**